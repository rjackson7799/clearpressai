@import "tailwindcss";
@import "tw-animate-css";

/* ===== Google Fonts Import ===== */
@import url('https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap');

@custom-variant dark (&:is(.dark *));

/* ===== CSS Custom Properties (Design Tokens) - Precision Clarity Theme ===== */
@theme {
  /* ===== Foundation Colors - Warm Paper System ===== */
  --color-background: oklch(98.5% 0.003 80);        /* Warm white paper */
  --color-background-subtle: oklch(96% 0.005 80);   /* Sunken paper */
  --color-background-elevated: oklch(100% 0 0);     /* Pure white cards */
  --color-foreground: oklch(18% 0.02 260);          /* Ink black */

  /* ===== Ink Scale - Softer than pure black ===== */
  --color-ink-primary: oklch(18% 0.02 260);
  --color-ink-secondary: oklch(45% 0.015 260);
  --color-ink-tertiary: oklch(62% 0.01 260);
  --color-ink-muted: oklch(72% 0.008 260);

  /* ===== Neutral Scale - Warm grays ===== */
  --color-gray-50: oklch(98% 0.003 80);
  --color-gray-100: oklch(96% 0.004 80);
  --color-gray-200: oklch(92% 0.005 80);
  --color-gray-300: oklch(86% 0.006 80);
  --color-gray-400: oklch(70% 0.008 260);
  --color-gray-500: oklch(55% 0.012 260);
  --color-gray-600: oklch(45% 0.015 260);
  --color-gray-700: oklch(35% 0.02 260);
  --color-gray-800: oklch(25% 0.025 260);
  --color-gray-900: oklch(18% 0.02 260);

  /* ===== Vermillion Primary (朱色 shu-iro) - Trust & Authority ===== */
  --color-primary: oklch(55% 0.18 25);
  --color-primary-hover: oklch(48% 0.2 25);
  --color-primary-active: oklch(42% 0.22 25);
  --color-primary-light: oklch(95% 0.03 25);
  --color-primary-foreground: oklch(100% 0 0);

  /* ===== Compliance Colors - Pharmaceutical Grade ===== */
  --color-compliance-excellent: oklch(52% 0.14 155);      /* Teal - 90+ */
  --color-compliance-excellent-light: oklch(94% 0.04 155);
  --color-compliance-good: oklch(58% 0.12 155);           /* Green - 70-89 */
  --color-compliance-good-light: oklch(94% 0.035 155);
  --color-compliance-warning: oklch(72% 0.15 75);         /* Amber - 50-69 */
  --color-compliance-warning-light: oklch(95% 0.04 75);
  --color-compliance-critical: oklch(55% 0.2 28);         /* Red - <50 */
  --color-compliance-critical-light: oklch(94% 0.035 28);

  /* ===== Semantic Colors ===== */
  --color-success: oklch(52% 0.14 155);
  --color-success-light: oklch(94% 0.04 155);
  --color-warning: oklch(72% 0.15 75);
  --color-warning-light: oklch(95% 0.04 75);
  --color-error: oklch(55% 0.2 28);
  --color-error-light: oklch(94% 0.035 28);
  --color-info: oklch(58% 0.14 240);
  --color-info-light: oklch(94% 0.035 240);

  /* ===== Status Colors - Professional & Muted ===== */
  --color-status-draft: oklch(72% 0.01 260);
  --color-status-draft-bg: oklch(96% 0.004 260);
  --color-status-in-progress: oklch(58% 0.12 240);
  --color-status-in-progress-bg: oklch(94% 0.035 240);
  --color-status-in-review: oklch(58% 0.14 290);
  --color-status-in-review-bg: oklch(94% 0.04 290);
  --color-status-needs-revision: oklch(68% 0.16 55);
  --color-status-needs-revision-bg: oklch(94% 0.04 55);
  --color-status-approved: oklch(52% 0.14 155);
  --color-status-approved-bg: oklch(94% 0.04 155);
  --color-status-completed: oklch(52% 0.14 155);
  --color-status-completed-bg: oklch(94% 0.04 155);

  /* ===== Urgency Colors ===== */
  --color-urgency-standard: oklch(55% 0.012 260);
  --color-urgency-priority: oklch(72% 0.15 75);
  --color-urgency-urgent: oklch(68% 0.18 45);
  --color-urgency-crisis: oklch(55% 0.2 28);

  /* ===== Dashboard Stat Colors ===== */
  --color-stat-projects: oklch(58% 0.14 240);           /* Blue */
  --color-stat-projects-light: oklch(94% 0.035 240);
  --color-stat-content: oklch(72% 0.15 75);             /* Amber */
  --color-stat-content-light: oklch(95% 0.04 75);
  --color-stat-clients: oklch(52% 0.14 155);            /* Emerald/Teal */
  --color-stat-clients-light: oklch(94% 0.04 155);
  --color-stat-approval: oklch(58% 0.14 290);           /* Violet */
  --color-stat-approval-light: oklch(94% 0.04 290);

  /* ===== UI Elements ===== */
  --color-border: oklch(90% 0.006 80);
  --color-border-hover: oklch(82% 0.008 80);
  --color-border-focus: oklch(55% 0.18 25);
  --color-ring: oklch(55% 0.18 25);
  --color-input: oklch(96% 0.004 80);
  --color-muted: oklch(96% 0.004 80);
  --color-muted-foreground: oklch(45% 0.015 260);
  --color-accent: oklch(95% 0.03 25);
  --color-accent-foreground: oklch(42% 0.2 25);

  /* ===== Destructive ===== */
  --color-destructive: oklch(55% 0.2 28);
  --color-destructive-foreground: oklch(100% 0 0);

  /* ===== Card ===== */
  --color-card: oklch(100% 0 0);
  --color-card-foreground: oklch(18% 0.02 260);

  /* ===== Popover ===== */
  --color-popover: oklch(100% 0 0);
  --color-popover-foreground: oklch(18% 0.02 260);

  /* ===== Secondary ===== */
  --color-secondary: oklch(96% 0.004 80);
  --color-secondary-foreground: oklch(18% 0.02 260);

  /* ===== Radius - Slightly softer ===== */
  --radius-sm: 0.25rem;
  --radius: 0.5rem;
  --radius-md: 0.625rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.25rem;
  --radius-full: 9999px;

  /* ===== Layout - Updated for Client Portal ===== */
  --width-sidebar: 260px;
  --width-sidebar-collapsed: 72px;
  --width-detail-panel: 360px;
  --height-header: 64px;
  --height-header-mobile: 56px;
  --height-bottom-nav: 72px;

  /* ===== Shadows - Soft depth ===== */
  --shadow-sm: 0 1px 2px oklch(0% 0 0 / 0.04);
  --shadow: 0 2px 8px oklch(0% 0 0 / 0.06);
  --shadow-md: 0 4px 16px oklch(0% 0 0 / 0.08);
  --shadow-lg: 0 8px 32px oklch(0% 0 0 / 0.1);
  --shadow-elevated: 0 4px 20px oklch(0% 0 0 / 0.08), 0 0 0 1px oklch(0% 0 0 / 0.02);

  /* ===== Animation Timing ===== */
  --duration-fast: 150ms;
  --duration-normal: 200ms;
  --duration-slow: 300ms;
  --duration-slower: 500ms;
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
  --ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
}

/* ===== Typography - Precision Clarity ===== */
@layer base {
  :root {
    /* Display font for Japanese headings - authoritative serif */
    --font-display: "Shippori Mincho", "Hiragino Mincho ProN", "Yu Mincho", "MS PMincho", serif;
    /* Body font - clean, legible sans-serif optimized for Japanese */
    --font-sans: "Noto Sans JP", "Hiragino Sans", "Hiragino Kaku Gothic ProN", system-ui, sans-serif;
    /* Monospace for scores, versions, code */
    --font-mono: "JetBrains Mono", "Fira Code", "SF Mono", monospace;
  }

  * {
    @apply border-border;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: var(--font-sans);
    font-feature-settings: "rlig" 1, "calt" 1, "palt" 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* ===== Display Typography (Japanese Headlines) ===== */
  .font-display {
    font-family: var(--font-display);
    font-feature-settings: "palt" 1;
    letter-spacing: -0.02em;
  }

  /* ===== Japanese Text Optimization ===== */
  .japanese-text,
  [lang="ja"] p,
  [lang="ja"] .prose {
    line-height: 1.8;
    letter-spacing: 0.02em;
    word-break: keep-all;
    overflow-wrap: break-word;
    font-feature-settings: "palt" 1;
  }

  /* ===== Heading Styles ===== */
  h1, h2, h3, .heading {
    font-family: var(--font-display);
    font-weight: 600;
    letter-spacing: -0.02em;
    color: var(--color-ink-primary);
  }

  h1 { font-size: 1.75rem; line-height: 1.3; }
  h2 { font-size: 1.25rem; line-height: 1.4; }
  h3 { font-size: 1.125rem; line-height: 1.4; }

  /* ===== Monospace for Data ===== */
  .font-mono, code, .score, .version {
    font-family: var(--font-mono);
    font-feature-settings: "tnum" 1;
  }
}

/* ===== Focus States ===== */
@layer utilities {
  .focus-ring {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
  }

  .focus-ring-vermillion {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2;
  }
}

/* ===== Animation Utilities ===== */
@layer utilities {
  /* Spring animations */
  .animate-spring {
    animation-timing-function: var(--ease-spring);
  }

  .animate-ease-out {
    animation-timing-function: var(--ease-out);
  }

  /* Fade & slide animations */
  .animate-fade-in {
    animation: fadeIn var(--duration-normal) var(--ease-out) forwards;
  }

  .animate-fade-up {
    animation: fadeUp var(--duration-slow) var(--ease-spring) forwards;
  }

  .animate-fade-down {
    animation: fadeDown var(--duration-slow) var(--ease-spring) forwards;
  }

  .animate-scale-in {
    animation: scaleIn var(--duration-normal) var(--ease-spring) forwards;
  }

  /* Slide indicator for tabs */
  .animate-slide {
    transition: transform var(--duration-normal) var(--ease-spring),
                width var(--duration-normal) var(--ease-spring);
  }

  /* Circular progress animation */
  .animate-ring {
    animation: drawRing 800ms var(--ease-out) forwards;
  }

  /* Pulse for pending items */
  .animate-pulse-subtle {
    animation: pulseSubtle 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  /* Count up animation trigger */
  .animate-count {
    animation: countUp var(--duration-slower) var(--ease-out) forwards;
  }

  /* Stagger children */
  .stagger-children > * {
    animation-fill-mode: both;
  }
  .stagger-children > *:nth-child(1) { animation-delay: 0ms; }
  .stagger-children > *:nth-child(2) { animation-delay: 50ms; }
  .stagger-children > *:nth-child(3) { animation-delay: 100ms; }
  .stagger-children > *:nth-child(4) { animation-delay: 150ms; }
  .stagger-children > *:nth-child(5) { animation-delay: 200ms; }
  .stagger-children > *:nth-child(6) { animation-delay: 250ms; }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .animate-spring,
    .animate-fade-in,
    .animate-fade-up,
    .animate-fade-down,
    .animate-scale-in,
    .animate-slide,
    .animate-ring,
    .animate-pulse-subtle,
    .animate-count {
      animation: none !important;
      transition: none !important;
    }
  }
}

/* ===== Keyframes ===== */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeDown {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes drawRing {
  from {
    stroke-dashoffset: var(--ring-circumference, 283);
  }
  to {
    stroke-dashoffset: var(--ring-offset, 0);
  }
}

@keyframes pulseSubtle {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

@keyframes countUp {
  from { opacity: 0; transform: translateY(4px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== Card Elevation Variants ===== */
@layer components {
  .card-elevated {
    @apply bg-card rounded-lg;
    box-shadow: var(--shadow-elevated);
    transition: box-shadow var(--duration-fast) var(--ease-out),
                transform var(--duration-fast) var(--ease-out);
  }

  .card-elevated:hover {
    box-shadow: var(--shadow-md);
    transform: translateY(-1px);
  }

  .card-elevated:active {
    transform: scale(0.99);
  }

  .card-flat {
    @apply bg-card rounded-lg border border-border;
  }

  .card-sunken {
    @apply rounded-lg;
    background: var(--color-background-subtle);
  }
}

/* ===== Frosted Glass Effect ===== */
@layer components {
  .glass {
    background: oklch(100% 0 0 / 0.8);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }

  .glass-subtle {
    background: oklch(100% 0 0 / 0.6);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
}

/* ===== Vermillion Accent Border ===== */
@layer components {
  .border-accent-left {
    border-left: 3px solid var(--color-primary);
  }

  .border-accent-bottom {
    border-bottom: 2px solid var(--color-primary);
  }
}

/* ===== Status Badge Styles ===== */
@layer components {
  .badge-status-draft {
    background: var(--color-status-draft-bg);
    color: var(--color-status-draft);
  }

  .badge-status-in-progress {
    background: var(--color-status-in-progress-bg);
    color: var(--color-status-in-progress);
  }

  .badge-status-in-review {
    background: var(--color-status-in-review-bg);
    color: var(--color-status-in-review);
  }

  .badge-status-needs-revision {
    background: var(--color-status-needs-revision-bg);
    color: var(--color-status-needs-revision);
  }

  .badge-status-approved {
    background: var(--color-status-approved-bg);
    color: var(--color-status-approved);
  }

  .badge-status-completed {
    background: var(--color-status-completed-bg);
    color: var(--color-status-completed);
  }
}

/* ===== Compliance Score Colors ===== */
@layer components {
  .compliance-excellent {
    --compliance-color: var(--color-compliance-excellent);
    --compliance-bg: var(--color-compliance-excellent-light);
  }

  .compliance-good {
    --compliance-color: var(--color-compliance-good);
    --compliance-bg: var(--color-compliance-good-light);
  }

  .compliance-warning {
    --compliance-color: var(--color-compliance-warning);
    --compliance-bg: var(--color-compliance-warning-light);
  }

  .compliance-critical {
    --compliance-color: var(--color-compliance-critical);
    --compliance-bg: var(--color-compliance-critical-light);
  }
}

/* ===== Compliance Mark Inline Highlighting (Grammar-Checker Style) ===== */
@layer components {
  /* Error marks - Red wavy underline (must fix) */
  .compliance-mark-error {
    text-decoration: underline wavy;
    text-decoration-color: var(--color-error);
    text-underline-offset: 3px;
    text-decoration-thickness: 1.5px;
    cursor: pointer;
    background-color: var(--color-error-light);
    border-radius: 2px;
    padding: 0 1px;
    transition: background-color var(--duration-fast) var(--ease-out);
  }

  .compliance-mark-error:hover {
    background-color: oklch(90% 0.05 28);
  }

  /* Warning marks - Yellow wavy underline (should fix) */
  .compliance-mark-warning {
    text-decoration: underline wavy;
    text-decoration-color: var(--color-warning);
    text-underline-offset: 3px;
    text-decoration-thickness: 1.5px;
    cursor: pointer;
    background-color: var(--color-warning-light);
    border-radius: 2px;
    padding: 0 1px;
    transition: background-color var(--duration-fast) var(--ease-out);
  }

  .compliance-mark-warning:hover {
    background-color: oklch(92% 0.06 75);
  }

  /* Suggestion marks - Blue dotted underline (consider) */
  .compliance-mark-suggestion {
    text-decoration: underline dotted;
    text-decoration-color: var(--color-info);
    text-underline-offset: 3px;
    text-decoration-thickness: 1.5px;
    cursor: pointer;
    transition: background-color var(--duration-fast) var(--ease-out);
  }

  .compliance-mark-suggestion:hover {
    background-color: var(--color-info-light);
    border-radius: 2px;
  }

  /* Flash animation for "View in Context" highlighting */
  .compliance-mark-flash {
    animation: complianceFlash 1.5s ease-out;
  }

  @keyframes complianceFlash {
    0%, 100% {
      background-color: inherit;
    }
    25%, 75% {
      background-color: oklch(85% 0.12 75);
    }
  }
}

/* ===== Theme Variables Mapping ===== */
@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --radius-2xl: calc(var(--radius) + 8px);
  --radius-3xl: calc(var(--radius) + 12px);
  --radius-4xl: calc(var(--radius) + 16px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

:root {
  --radius: 0.5rem;
  --background: oklch(98.5% 0.003 80);
  --foreground: oklch(18% 0.02 260);
  --card: oklch(100% 0 0);
  --card-foreground: oklch(18% 0.02 260);
  --popover: oklch(100% 0 0);
  --popover-foreground: oklch(18% 0.02 260);
  --primary: oklch(55% 0.18 25);
  --primary-foreground: oklch(100% 0 0);
  --secondary: oklch(96% 0.004 80);
  --secondary-foreground: oklch(18% 0.02 260);
  --muted: oklch(96% 0.004 80);
  --muted-foreground: oklch(45% 0.015 260);
  --accent: oklch(95% 0.03 25);
  --accent-foreground: oklch(42% 0.2 25);
  --destructive: oklch(55% 0.2 28);
  --border: oklch(90% 0.006 80);
  --input: oklch(96% 0.004 80);
  --ring: oklch(55% 0.18 25);
  --chart-1: oklch(55% 0.18 25);
  --chart-2: oklch(52% 0.14 155);
  --chart-3: oklch(58% 0.14 240);
  --chart-4: oklch(72% 0.15 75);
  --chart-5: oklch(58% 0.14 290);
  --sidebar: oklch(100% 0 0 / 0.8);
  --sidebar-foreground: oklch(18% 0.02 260);
  --sidebar-primary: oklch(55% 0.18 25);
  --sidebar-primary-foreground: oklch(100% 0 0);
  --sidebar-accent: oklch(95% 0.03 25);
  --sidebar-accent-foreground: oklch(42% 0.2 25);
  --sidebar-border: oklch(90% 0.006 80);
  --sidebar-ring: oklch(55% 0.18 25);
}

.dark {
  --background: oklch(14% 0.015 260);
  --foreground: oklch(96% 0.004 80);
  --card: oklch(18% 0.02 260);
  --card-foreground: oklch(96% 0.004 80);
  --popover: oklch(18% 0.02 260);
  --popover-foreground: oklch(96% 0.004 80);
  --primary: oklch(65% 0.18 25);
  --primary-foreground: oklch(100% 0 0);
  --secondary: oklch(22% 0.02 260);
  --secondary-foreground: oklch(96% 0.004 80);
  --muted: oklch(22% 0.02 260);
  --muted-foreground: oklch(65% 0.01 260);
  --accent: oklch(25% 0.06 25);
  --accent-foreground: oklch(65% 0.18 25);
  --destructive: oklch(60% 0.2 28);
  --border: oklch(100% 0 0 / 0.1);
  --input: oklch(100% 0 0 / 0.12);
  --ring: oklch(65% 0.18 25);
  --chart-1: oklch(65% 0.18 25);
  --chart-2: oklch(60% 0.14 155);
  --chart-3: oklch(65% 0.14 240);
  --chart-4: oklch(75% 0.15 75);
  --chart-5: oklch(65% 0.14 290);
  --sidebar: oklch(18% 0.02 260);
  --sidebar-foreground: oklch(96% 0.004 80);
  --sidebar-primary: oklch(65% 0.18 25);
  --sidebar-primary-foreground: oklch(100% 0 0);
  --sidebar-accent: oklch(25% 0.06 25);
  --sidebar-accent-foreground: oklch(65% 0.18 25);
  --sidebar-border: oklch(100% 0 0 / 0.1);
  --sidebar-ring: oklch(65% 0.18 25);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}
